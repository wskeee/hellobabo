!function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=5)}([function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DisplayObjectUitl=void 0;var r=function(){function e(){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this)}return function(e,t,i){i&&n(e,i)}(e,0,[{key:"enabled",value:function(t,i,n,o,r,a){if(null==i&&(i=!0),null==n&&(n=!0),null==o&&(o=!0),null==r&&(r=!1),null==a&&(a=e.disableAlpha),o&&(t.mouseEnabled=i),n){var s=t.filters||[];if(i){var l=s.findIndex(function(t){return t==e.blackAndWhiteFilter});-1!=l&&(s=s.splice(l,1),t.filters=s)}else s.push(e.blackAndWhiteFilter),t.filters=s}r&&(t.alpha=i?1:a)}},{key:"setEnabled",value:function(t,i,n,o,r,a){e.enabled(t,i,n,o,r,a)}},{key:"setPopBlur",value:function(t,i){var n=t.filters||[];if(null==i&&(i=!0),i)n.push(e.popBlurFilter),t.filters=n;else{var o=n.findIndex(function(t){return t==e.popBlurFilter});-1!=o&&(n=n.splice(o,1),t.filters=n)}}},{key:"scale",value:function(e,t,i,n,o){var r=!(5<arguments.length&&void 0!==arguments[5])||arguments[5],a=n/t,s=o/i,l=Math.min(a,s);return e.scaleX=e.scaleY=l,r&&(e.x=n-t*l>>1,e.y=o-i*l>>1),l}}]),e}();o(t.DisplayObjectUitl=r,"colorMatrix",new createjs.ColorMatrix),o(r,"blackAndWhiteFilter",new createjs.ColorMatrixFilter(r.colorMatrix)),o(r,"popBlurFilter",new createjs.BlurFilter(30,30,4)),o(r,"disableAlpha",.5),r.colorMatrix.adjustSaturation(-100);var a={isPC:function(){for(var e=navigator.userAgent,t=new Array("Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"),i=!0,n=0;n<t.length;n++)if(0<e.indexOf(t[n])){i=!1;break}return i}};t.default=a},function(e,t,i){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Event=t.default=void 0;var l,u,c,h=function(){function e(){return o(this,e),r(this,a(e).apply(this,arguments))}return s(e,createjs.EventDispatcher),e}();t.default=h,u="instance",c=new(l=h),u in l?Object.defineProperty(l,u,{value:c,enumerable:!0,configurable:!0,writable:!0}):l[u]=c;var d=function(){function e(t,i){var n;return o(this,e),(n=r(this,a(e).call(this,t))).data=i,n}return s(e,createjs.Event),e}();t.Event=d},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(i(3)),o=s(i(6)),r=s(i(8)),a=s(i(0));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var c=function(){function e(){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.stage,this.canvas,this.anim_container,this.dom_overlay_container,this.stageWidth=0,this.stageHeight=0}return function(e,t,i){t&&l(e.prototype,t)}(e,[{key:"init",value:function(e,t,i){var o=this;window.playSound=this.playSound;var r=this.appData=window.appData;this.libs=[r.common].concat(r.scenes),this.canvas=e,this.anim_container=t,this.dom_overlay_container=i,this.loader=n.default.r,this.loader.load(this.libs),this.loader.addEventListener("progress",function(e){document.getElementById("preloader-txt").innerText=Math.round(100*e.progress)+"%"}),this.loader.addEventListener("resload",function(e){if(e.resId==r.common.id){var t=document.getElementsByClassName("preloader-box")[0];t&&(t.style.display="none"),o.initStage(),o.initView()}}),this.loader.addEventListener("complete",function(e){console.log("所有资源加载完成！")})}},{key:"initStage",value:function(){var t=this,i=this.exportRoot=new createjs.Container,n=this.stage=new createjs.StageGL(this.canvas);this.resize(),n.addChild(i),createjs.Ticker.timingMode=createjs.Ticker.RAF_SYNCHED,createjs.Ticker.framerate=e.fps,createjs.Ticker.addEventListener("tick",function(e){return t.handleTick(e)})}},{key:"initView",value:function(){var t=this.exportRoot,i=new o.default(e.w,e.h);t.addChild(i),r.default.init(a.default.isPC()?this.stage:this.canvas,i,e.w,e.h)}},{key:"playSound",value:function(e,t){return createjs.Sound.play(e)}},{key:"handleTick",value:function(t){var i=this.stage,n=this.exportRoot;n&&n.cache(0,0,e.w,e.h),i.update()}},{key:"getProjectionMatrix",value:function(t,i){var n=e.w/2,o=e.h/2,r=(i+528.25)/528.25,a=new createjs.Matrix2D;a.a=1/r,a.d=1/r;var s=new createjs.Matrix2D;return s.tx=-n,s.ty=-o,(s=s.prependMatrix(a)).tx+=n,s.ty+=o,s}},{key:"analyzeRootDepth",value:function(){var e=this.exportRoot.___camera___instance;void 0!==e&&void 0!==e.pinToObject&&(e.x=e.pinToObject.x+e.pinToObject.pinOffsetX,e.y=e.pinToObject.y+e.pinToObject.pinOffsetY,void 0!==e.pinToObject.parent&&void 0!==e.pinToObject.parent.depth&&(e.depth=e.pinToObject.parent.depth+e.pinToObject.pinOffsetZ)),this.applyLayerZDepth(this.exportRoot)}},{key:"applyLayerZDepth",value:function(t){var i=t.___camera___instance,n={x:0,y:0};if(t===this.exportRoot){var o={x:e.w/2,y:e.h/2};n.x=o.x,n.y=o.y}for(var r in t.children){var a=t.children[r];if(a!=i&&(this.applyLayerZDepth(a,i),void 0!==a.layerDepth)){a.currentFrame!=a.parent.currentFrame&&a.gotoAndPlay(a.parent.currentFrame);var s=new createjs.Matrix2D,l=new createjs.Matrix2D,u=a.layerDepth?a.layerDepth:0,c=0;if(i&&!a.isAttachedToCamera){var h=i.getMatrix();h.tx-=n.x,h.ty-=n.y,(l=h.invert()).prependTransform(n.x,n.y,1,1,0,0,0,0,0),l.appendTransform(-n.x,-n.y,1,1,0,0,0,0,0),i.depth&&(c=i.depth)}if(a.depth&&(u=a.depth),(u-=c)<-528.25)s.a=0,s.d=0;else{if(a.layerDepth){var d=this.getProjectionMatrix(t,a.layerDepth);d&&(d.invert(),s.prependMatrix(d))}s.prependMatrix(l);var f=this.getProjectionMatrix(t,u);f&&s.prependMatrix(f)}a.transformMatrix=s}}}},{key:"makeResponsive",value:function(e,t,i,n){var o=this;window.addEventListener("resize",function(r){return o.resizeCanvas(e,t,i,n)}),this.resizeCanvas(e,t,i,n)}},{key:"resizeCanvas",value:function(t,i,n,o){var r,a,s=1,l=this.stage,u=this.canvas;function c(){var c=e.w,h=e.h,d=window.innerWidth,f=window.innerHeight,v=window.devicePixelRatio||1,p=d/c,y=f/h,g=1;t&&("width"==i&&r==d||"height"==i&&a==f?g=s:n?1==o?g=Math.min(p,y):2==o&&(g=Math.max(p,y)):(d<c||f<h)&&(g=Math.min(p,y))),u.width=c*v*g,u.height=h*v*g,u.style.width=c*g+"px",u.style.height=h*g+"px",l.scaleX=v*g,l.scaleY=v*g,r=d,a=f,s=g,l.tickOnUpdate=!1,l.updateViewport(u.width,u.height),l.tickOnUpdate=!0}window.addEventListener("resize",c),c()}},{key:"resize",value:function(){var t=1/window.devicePixelRatio,i=this,n=this.canvas,o=this.stage,r=this.exportRoot,a=this.stageWidth,s=this.stageHeight;document.querySelector('meta[name="viewport"]').setAttribute("content","width=device-width,initial-scale="+t+", maximum-scale="+t+", minimum-scale="+t+", user-scalable=no"),function(){if(a!=document.documentElement.clientWidth||s!=document.documentElement.clientHeight){a=i.stageWidth=document.documentElement.clientWidth,s=i.stageHeight=document.documentElement.clientHeight,n.width=a,n.height=s;var t=a/e.w,l=s/e.h;r.scaleX=t,r.scaleY=l}o.updateViewport(a,s)}()}}]),e}();u(t.default=c,"w",1080),u(c,"h",1778),u(c,"fps",60),u(c,"commonResId","E4019F635D6CBC488C42C0A8B05F0249")},function(e,t,i){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}function s(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Loader=t.ResLoadEvent=t.ProgressEvent=t.default=void 0;var c,h=function(){function e(){var t;return o(this,e),(t=s(this,l(e).call(this))).comps={},t.libs={},t.loaders={},t.queues=[],t.configs=[],t.loaded={},t._curConfig=null,t._loading=!1,t}return u(e,createjs.EventDispatcher),a(e,[{key:"_addQueue",value:function(e){this.queues.push(e),this._nextQueue()}},{key:"_nextQueue",value:function(){0<this.queues.length?this._loading||(this._loading=!0,this._load(this.queues.shift())):this.dispatchEvent("complete")}},{key:"_load",value:function(e){var t=this;this._curConfig=e;var i=new v;i.addEventListener("progress",function(e){return t._handleProgress(e)}),i.addEventListener("complete",function(e){return t._handleComplete(e)}),i.load(e),this.loaders[e.id]=i}},{key:"_handleProgress",value:function(e){var t=this.configs.length,i=t-this.queues.length-1,n=1/t,o=i*n;this.dispatchEvent(new d(i,t,o+e.progress*n,{progress:e.progress,resId:this._curConfig.id}))}},{key:"_handleComplete",value:function(e){this._loading=!1,this.loaded[this._curConfig.id]=!0,this.dispatchEvent(new f(this._curConfig.id)),this._nextQueue()}},{key:"load",value:function(e){var t=this;this.configs=this.configs.concat(e),e.forEach(function(e){var i=AdobeAn.getComposition(e.id),n=i.getLibrary();t.loaded[e.id]=!1,t.comps[e.id]=i,t.libs[e.id]=n,t._addQueue(e)}),this._nextQueue()}},{key:"getLibRes",value:function(e,t){return new(this.getLib(t)[e])}},{key:"getComp",value:function(e){return this.comps[e]}},{key:"getLib",value:function(e){return this.libs[e]}},{key:"getLoader",value:function(e){return this.loaders[e]}},{key:"getLibHasDone",value:function(e){return this.loaded[e]}}],[{key:"r",get:function(){return e._r||(e._r=new e),e._r}}]),e}();t.default=h,"_r"in(c=h)?Object.defineProperty(c,"_r",{value:null,enumerable:!0,configurable:!0,writable:!0}):c._r=null;var d=function(){function e(t,i,n,r){var a;return o(this,e),(a=s(this,l(e).call(this,"progress"))).load=t,a.total=i,a.progress=n,a.data=r,a}return u(e,createjs.Event),e}();t.ProgressEvent=d;var f=function(){function e(t){var i;return o(this,e),(i=s(this,l(e).call(this,"resload"))).resId=t,i}return u(e,createjs.Event),e}();t.ResLoadEvent=f;var v=function(){function e(){var t;return o(this,e),t=s(this,l(e).call(this)),createjs.Sound.alternateExtensions=["mp3"],t}return u(e,createjs.EventDispatcher),a(e,[{key:"_load",value:function(e){var t=this,i=e.id,n=e.path;this.comp=AdobeAn.getComposition(i);var o=this.comp.getLibrary(),r=new createjs.LoadQueue(!0,n);r.installPlugin(createjs.Sound),r.addEventListener("fileload",function(e){return t._handleFileLoad(e)}),r.addEventListener("progress",function(e){return t._handleProgress(e)}),r.addEventListener("complete",function(e){return t._handleComplete(e)}),r.loadManifest(o.properties.manifest),this.sourceLoader=r}},{key:"_handleFileLoad",value:function(e){var t=this.comp.getImages();e&&"image"==e.item.type&&(t[e.item.id]=e.result),this.dispatchEvent(e.clone())}},{key:"_handleProgress",value:function(e){this.dispatchEvent(e.clone())}},{key:"_handleComplete",value:function(e){for(var t=this.comp,i=t.getLibrary(),n=t.getSpriteSheet(),o=e.target,r=i.ssMetadata,a=0;a<r.length;a++)n[r[a].name]=new createjs.SpriteSheet({images:[o.getResult(r[a].name)],frames:r[a].frames});AdobeAn.compositionLoaded(this.config.id),this.dispatchEvent(e.clone())}},{key:"load",value:function(e){this.comp=null,this.config=e,this._load(e)}}]),e}();t.Loader=v},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(0),o=i(1);function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}function u(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var f=function(){function e(t,i,n){var o,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:400,s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:300;return a(this,e),(o=u(this,c(e).call(this))).id="video_"+Math.round(99999999*Math.random()),o.width=r,o.height=s,o.src=t,o.autoPlay=i,o.video=n,o.videoBuffer=new createjs.VideoBuffer(n),o.videoBM=new createjs.Bitmap(o.videoBuffer),o.videoWidth=o.videoHeight=0,o.initVideoEvent(),o.initControl(),o}return h(e,createjs.Container),l(e,[{key:"initControl",value:function(){this.control=new v(this,this.width,this.height),this.addChild(this.control)}},{key:"initVideoEvent",value:function(){var e=this;this.video.addEventListener("play",function(t){e.dispatchEvent(new o.Event("playing"))}),this.video.addEventListener("loadedmetadata",function(t){e.onVideoEvent(t)})}},{key:"onVideoEvent",value:function(e){switch(console.log(e),e.type){case"loadedmetadata":this.videoWidth=this.video.videoWidth,this.videoHeight=this.video.videoHeight}}},{key:"seek",value:function(e){this.video.currentTime=e}},{key:"play",value:function(){try{this.video.play()}catch(e){}}},{key:"pause",value:function(){try{this.video.pause()}catch(e){}}},{key:"toggle",value:function(){this.video.paused?this.play():this.pause()}},{key:"destory",value:function(){this.pause(),this.video.remove(),this.control.destory(),this.parent.removeChild(this)}},{key:"isPlaying",get:function(){return!this.video.paused}}],[{key:"getVideo",value:function(t,i,n,o){var r=2<arguments.length&&void 0!==n?n:400,a=3<arguments.length&&void 0!==o?o:300,s=document.getElementsByClassName("video-box")[0];s||((s=document.createElement("div")).className="video-box",document.body.appendChild(s));var l=window.appData?window.appData.path:"";t=-1==t.indexOf("http://")?l+t:t;var u=document.createElement("video");s.append(u),u.src=t,u.autoPlay=i,u.style.display="none",u.setAttribute("webkit-playsinline",!0),u.setAttribute("playsinline",!0),u.setAttribute("x5-video-player-type","h5");var c=new e(t,i,u,r,a);return e.videos.push(c),c}},{key:"destoryAllVideo",value:function(){e.videos.forEach(function(e){return e.destory()}),e.videos=[]}}]),e}();d(t.default=f,"videos",[]);var v=function(){function e(t){var i,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:300,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:200;return a(this,e),(i=u(this,c(e).call(this))).video=t,i.width=n,i.height=o,i.initChild(),i.initVideoEvent(),i}return h(e,createjs.Container),l(e,[{key:"initChild",value:function(){var e=this,t=window.lib;this.play_icon=new t.play_icon,this.pause_icon=new t.pause_icon,this.bar=new p(this.width,10),this.content=new createjs.Container,this.addChild(this.content),this.addChild(this.play_icon),this.addChild(this.pause_icon),this.addChild(this.bar),this.content.addChild(this.video.videoBM),this.bar.addEventListener(y.CHANGED,function(t){var i=t.data.percentage;e.video.seek(e.video.duration*i)}),this.addEventListener("mousedown",function(t){e.video.toggle()}),this.refresh()}},{key:"initVideoEvent",value:function(){var e=this,t=this.video.video;t.addEventListener("play",function(t){e.onVideoEvent(t)}),t.addEventListener("pause",function(t){e.onVideoEvent(t)}),t.addEventListener("timeupdate",function(t){e.onVideoEvent(t)}),t.addEventListener("loadedmetadata",function(t){e.onVideoEvent(t)})}},{key:"onVideoEvent",value:function(e){switch(e.type){case"play":case"pause":this.showControl(),this.refresh();break;case"loadedmetadata":this.refresh();break;case"timeupdate":this.bar.setValue(this.video.currentTime/this.video.duration)}}},{key:"refresh",value:function(){this.video.videoBM&&n.DisplayObjectUitl.scale(this.video.videoBM,this.video.videoWidth,this.video.videoHeight,this.width,this.height),this.play_icon.visible=!this.video.isPlaying,this.pause_icon.visible=this.video.isPlaying,this.play_icon.x=this.pause_icon.x=this.width>>1,this.play_icon.y=this.pause_icon.y=this.height>>1,this.bar.y=this.height-this.bar.height}},{key:"showControl",value:function(e,t){var i=this,n=!(0<arguments.length&&void 0!==e)||e,o=1<arguments.length&&void 0!==t?t:2e3;clearTimeout(this.hideDelay),this._showControl(!0),n&&(this.hideDelay=setTimeout(function(){i._showControl(!1)},o))}},{key:"_showControl",value:function(e){console.log("_showControl",e),this.play_icon.visible=this.pause_icon.visible=this.bar.visible=e}},{key:"destory",value:function(){this.bar.removeAllEventListeners(y.CHANGED),this.removeAllEventListeners("mousedown")}}]),e}(),p=function(){function e(){var t,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:100,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"#28b28b",r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"#ffffff";return a(this,e),(t=u(this,c(e).call(this))).value=0,t.width=i,t.height=n,t.doneColor=o,t.railColor=r,t.initChild(),t}return h(e,createjs.Container),l(e,[{key:"initChild",value:function(){var e=this;this.done=new createjs.Shape,this.rail=new createjs.Shape,this.addEventListener("mousedown",function(t){var i=e.width,n=e.ui.globalToLocal(t.stageX,t.stageY).x/i;t.stopImmediatePropagation(),t.stopPropagation(),e.dispatchEvent(new y(y.CHANGED,{percentage:n}))}),this.setValue(0)}},{key:"setValue",value:function(e){this.value=e,this.draw()}},{key:"draw",value:function(){this.done.graphics.clear(),this.done.graphics.beginFill(this.doneColor),this.done.graphics.drawRect(0,0,this.width*this.value,this.height),this.done.graphics.clear(),this.rail.graphics.beginFill(this.railColor),this.rail.graphics.drawRect(0,0,this.width,this.height)}}]),e}(),y=function(){function e(t,i){var n;return a(this,e),(n=u(this,c(e).call(this,t))).data=i,n}return h(e,createjs.Event),e}();d(y,"CHANGED","changed")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(i(2)),o=l(i(1)),r=i(0),a=l(i(4)),s=i(9);function l(e){return e&&e.__esModule?e:{default:e}}var u={coms:{Video:a.default},utils:{DisplayObjectUitl:r.DisplayObjectUitl,Emitter:s.Emitter},manager:{EventManager:o.default},hellobabo:{init:function(){try{document.createElement("canvas").getContext("2d")}catch(e){return}(new n.default).init(document.getElementById("book_canvas"),document.getElementById("animation_container"),document.getElementById("dom_overlay_container"))}}};Object.assign(u,window.wskeee||{}),window.onload=u.hellobabo.init;var c=window.wskeee=u;t.default=c},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};n.get||n.set?Object.defineProperty(t,i,n):t[i]=e[i]}return t.default=e,t}(i(1)),o=s(i(4)),r=s(i(3)),a=s(i(2));function s(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,i){return t&&c(e.prototype,t),i&&c(e,i),e}function d(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?v(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}s(i(7));var y,g,m,w=function(){function e(t,i){var n,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"h";return u(this,e),n=d(this,f(e).call(this)),e.instance=v(n),n.appData=window.appData,n.index=0,n.isLock=!1,n.isTween=!1,n.viewList=[],n.contentView=n.addChild(new createjs.Container),n.moveView=n.currentView=null,n.viewH=i,n.viewW=t,n.scrollDir=o,n.pageSize="h"==o?t:i,n.initChild(),n.initEvent(),n}return p(e,createjs.Container),h(e,[{key:"initChild",value:function(){var e,t=this;this.appData.scenes.forEach(function(i){e=new b(i,t.viewW,t.viewH),t.viewList.push(e)}),this.floatView=document.getElementsByClassName("float-view")[0],this.shareBtn=this.floatView.getElementsByClassName("share-btn")[0],this.buyBtn=this.floatView.getElementsByClassName("buy-btn")[0],this.pageNum=this.floatView.getElementsByClassName("page-num")[0],this.shareTxt=this.shareBtn.getElementsByClassName("share-txt")[0],this.currentView=this.viewList[0],this.currentView.active=!0,this.addContent(this.currentView),this.checkLock(0),this.pageNum.innerHTML="1 / "+this.viewList.length,this.shareBtn.style.display=this.buyBtn.style.display="none",this.floatView.style.display="flex",this.checkMiniProgram()}},{key:"checkMiniProgram",value:function(){console.log(wx.miniProgram);var e=this;wx.miniProgram.getEnv(function(t){console.log("wx.miniProgram.getEnv",t),t.miniprogram&&(e.shareBtn.style.display=e.buyBtn.style.display="flex",e.shareTxt.innerHTML="赚￥"+appData.goods.commission)})}},{key:"initEvent",value:function(){var e=this;this.shareBtn.addEventListener("mousedown",function(e){var t=1==appData.goods.type?appData.goods.gid:appData.goods.ogid;wx.miniProgram.navigateTo({url:"/pages/goods/share?type=".concat(appData.goods.type,"&id=").concat(t)})},!0),this.buyBtn.addEventListener("mousedown",function(e){wx.miniProgram.navigateTo({url:"/pages/order/create/create?goods_id=".concat(appData.goods.gid)})},!0),n.default.instance.addEventListener("sceneFinished",function(t){e.setSceneLock(e.index,!1)}),n.default.instance.addEventListener("nextScene",function(t){e.next()}),n.default.instance.addEventListener("prevScene",function(t){e.prev()}),n.default.instance.addEventListener("changeScene",function(t){e.changeIndex(t.data.value),e.showNav(!1)}),n.default.instance.addEventListener("hideNav",function(t){e.showNav(!1)})}},{key:"changeIndex",value:function(e){this.changeView(this.index>e?"next":"prev",e)}},{key:"changeView",value:function(e,t,i){if(!this.isTween&&this.index!=t){var n="h"==this.scrollDir?"x":"y",o=this.pageSize;this.moveView=this.viewList[t],this.addContent(this.moveView),this.moveView[n]=o,this.changeHandler("next",t,i)}}},{key:"changeHandler",value:function(e,t,i){var n=this;if(!(t<0||t>this.viewList.length-1)||1==i){var r=this.moveView,a=this.currentView,s="h"==this.scrollDir?"x":"y",l=this.pageSize,u={},c={};u[s]=0,this.isTween=!0,this.index=t,this.checkLock(t),this.pageNum.innerHTML=t+1+" / "+this.viewList.length,createjs.Sound.stop(),o.default.destoryAllVideo(),"next"==e?(c[s]=-l,createjs.Tween.get(a).to(c,400,createjs.Ease.sineOut).call(function(){return n.delayComplete()})):(c[s]=l,createjs.Tween.get(r).to(u,400,createjs.Ease.sineOut).call(function(){return n.delayComplete()}))}}},{key:"delayComplete",value:function(){var e=this.currentView;this.isTween=!1,e.active=!1,e.reset(),this.removeContent(e),(e=this.currentView=this.viewList[this.index]).active=!0,e.play()}},{key:"resumeHandler",value:function(t){var i=this.moveView,n=this.currentView,o="h"==this.scrollDir?"x":"y",r=this.pageSize,a={},s={};a[o]=0,e.bi=Math.abs(n[o]/r),s[o]="next"==t?-r:r,createjs.Tween.get(n).to(a,500*e.bi),createjs.Tween.get(i).to(s,500*e.bi).call(this.resumeComplete)}},{key:"resumeComplete",value:function(){var e=this.moveView;e&&this.removeContent(e)}},{key:"addContent",value:function(e){this.contentView.addChild(e)}},{key:"removeContent",value:function(e){e.parent&&e.parent.removeChild(e)}},{key:"next",value:function(){this.changeView("next",this.index+1)}},{key:"prev",value:function(){this.changeView("prev",this.index-1)}},{key:"lock",value:function(){this.isLock=!0}},{key:"unlock",value:function(){this.isLock=!1}},{key:"setSceneLock",value:function(e,t){this.appData.scenes[e].lock=t,this.checkLock(e)}},{key:"checkLock",value:function(e){var t=this.moveView?this.moveView:this.currentView;this.isLock=this.appData.scenes[e].lock,t.nextTips.visible=!this.isLock&&0==e&&1<this.viewList.length}},{key:"showNav",value:function(e){(this.navView.visible=e)?this.lock():this.checkLock(this.index)}}]),e}();t.default=w,m=void 0,(g="instance")in(y=w)?Object.defineProperty(y,g,{value:m,enumerable:!0,configurable:!0,writable:!0}):y[g]=m;var b=function(){function e(t,i,n){var o;return u(this,e),(o=d(this,f(e).call(this))).width=i,o.height=n,o.libConfig=t,o.active=!1,o.init(),o}return p(e,createjs.Container),h(e,[{key:"init",value:function(){var e=this,t=this.libConfig;this.borderShadow=r.default.r.getLibRes("border_shadow",a.default.commonResId),this.nextTips=r.default.r.getLibRes("next_tips",a.default.commonResId),this.nextTips.visible=!1;var i=this.loading=r.default.r.getLibRes("loading",a.default.commonResId);this.addChild(i),i.setTransform(this.width/2,this.height/2),r.default.r.addEventListener("progress",function(e){e.data.resId==t.id&&(i.txt.text=Math.round(100*e.data.progress)+"%")}),r.default.r.addEventListener("resload",function(i){i.resId==t.id&&e.initChild()})}},{key:"initChild",value:function(){this.removeChild(this.loading),this.content=r.default.r.getLibRes("page",this.libConfig.id),this.addChild(this.content),this.addChild(this.nextTips),this.addChild(this.borderShadow),this.nextTips.setTransform(this.width-5,this.height/2),this.borderShadow.setTransform(this.width,0,1,a.default.h/this.borderShadow.nominalBounds.height),this.active?this.content.play():this.content.gotoAndStop(0)}},{key:"play",value:function(){this.content&&this.content.play()}},{key:"reset",value:function(){this.content&&(this.content.stop(),this.content.gotoAndStop(0))}},{key:"stop",value:function(){this.content&&this.content.stop()}}]),e}()},function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return function(e,t,i){i&&n(e,i)}(e,0,[{key:"easeIn",value:function(e,t,i,n){return i?e+t*Math.pow(2,10*(i/n-1)):e}},{key:"easeOut",value:function(e,t,i,n){return i==n?e+t:e-(Math.pow(2,-10*i/n)+1)*t}},{key:"easeInOut",value:function(e,t,i,n){if(!i)return e;if(i==n)return e+t;var o=i/n*2;return o<1?t/2*Math.pow(2,10*(o-1))+e:t/2*(2-Math.pow(2,-10*--o))+e}}]),e}();t.default=o},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o=(n=i(0))&&n.__esModule?n:{default:n};function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var s=function(){function e(){!function(t,i){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this)}return function(e,t,i){i&&r(e,i)}(e,0,[{key:"init",value:function(t,i,n,r){var a=2<arguments.length&&void 0!==n?n:720,s=3<arguments.length&&void 0!==r?r:1280;e.stage=t,e.view=i,e.w=a,e.h=s,o.default.isPC()?e.mouseInit():e.touchInit()}},{key:"mouseInit",value:function(){var t="h"==e.scrollDir?"x":"y",i="h"==e.scrollDir?"X":"Y",n=0,o=0,r=!1,a="h"==e.scrollDir?e.w:e.h,s=e.stage,l=e.view;function u(e){if(!l.isTween&&!l.isLock){var i=l.index,n=0,r=l.viewList,s=r.length,u=l.moveView,c=l.currentView;s<i||(0<e&&0<i?(u=l.moveView=r[i-1],n=-a,u.parent||(u[t]=0,l.addContent(u)),u&&(u[t]=o+e+n)):e<0&&i<s&&(u=l.moveView=r[i+1],n=a,u&&(u.parent||(u[t]=0,l.addContent(u)),c[t]=o+e,l.addContent(c))))}}s.addEventListener("stagemousedown",function(e){l.isTween||l.isLock||(r=!0,n=e["raw".concat(i)],o=l[t])}),s.addEventListener("stagemousemove",function(e){l.isTween||l.isLock||0!=r&&u(e["raw".concat(i)]-n)}),s.addEventListener("stagemouseup",function(o){if(!l.isTween&&!l.isLock){var a=l.currentView,s=l.moveView,c=l.index,h=o["raw".concat(i)];n!=h?s&&s[t]<0?s[t]<-1?l.changeHandler("prev",c-1):l.resumeHandler("next"):a&&a[t]<0&&(a[t]<-1?l.changeHandler("next",c+1):l.resumeHandler("prev")):h<e.stage.canvas.width/2?0<c&&(u(1),l.changeHandler("prev",c-1)):c<l.viewList.length&&(u(-1),l.changeHandler("next",c+1)),r=!1}})}},{key:"touchInit",value:function(){var t="h"==e.scrollDir?"x":"y",i="h"==e.scrollDir?"X":"Y",n=0,o=0,r="h"==e.scrollDir?e.w:e.h,a=e.stage,s=e.view;function l(e){if(!s.isTween&&!s.isLock){var i=0,n=s.index,a=s.viewList,l=a.length,u=s.moveView,c=s.currentView;l<n||(0<e&&0<n?(u=s.moveView=a[n-1],i=-r,u.parent||(u[t]=0,s.addContent(u)),u&&(u[t]=o+e+i)):e<0&&n<l&&(u=s.moveView=a[n+1],i=r,u&&(u.parent||(u[t]=0,s.addContent(u)),c[t]=o+e,s.addContent(c))))}}a.addEventListener("touchstart",function(e){if(!s.isTween&&!s.isLock){e.preventDefault();var r=e.targetTouches[0];n=r["page".concat(i)],o=s[t]}},!1),a.addEventListener("touchmove",function(e){s.isTween||s.isLock||1!=e.targetTouches.length||(e.preventDefault(),l(e.targetTouches[0]["page".concat(i)]-n))},!1),a.addEventListener("touchend",function(o){if(!s.isTween&&!s.isLock){var r=s.index,a=s.currentView,u=s.moveView,c=o.changedTouches[0]["page".concat(i)];n!=c?u&&u[t]<0?u[t]<-1?s.changeHandler("prev",r-1):s.resumeHandler("next"):a&&a[t]<0&&(a[t]<-1?s.changeHandler("next",r+1):s.resumeHandler("prev")):c<e.stage.width/2?0<r&&(l(1),s.changeHandler("prev",r-1)):r<s.viewList.length&&(l(-1),s.changeHandler("next",r+1))}},!1)}}]),e}();a(t.default=s,"w",720),a(s,"h",1280),a(s,"stage",void 0),a(s,"view",void 0),a(s,"scrollDir","h"),a(s,"forbiddenZone",null)},function(e,t,i){"use strict";function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t,i,n,a,s,l,u){o(this,r),this.pos={x:e||0,y:t||0},this.speed=n||5,this.life=a||1,this.size=s||2,this.lived=0;var c=i*Math.PI/180;this.vel={x:Math.cos(c)*n,y:-Math.sin(c)*n},this.colour=l,this.colour_step=u}Object.defineProperty(t,"__esModule",{value:!0}),t.Emitter=t.Particle=void 0,t.Particle=r;var a=function(){function e(t,i,n){o(this,e),this.pos={x:t,y:i},this.settings=n,this._render=n.render,this.emission_delay=1e3/n.emission_rate,this.last_update=0,this.last_emission=0,this.particles=[],this.position_vary=this.settings.position_range||!1,this.min_position=this.settings.min_position||{x:0,y:0}}return function(e,t,i){t&&n(e.prototype,t)}(e,[{key:"update",value:function(){if(this.last_update){var e=Date.now(),t=e-this.last_update;if(this.last_emission+=t,this.last_update=e,this.last_emission>this.emission_delay){var i=Math.floor(this.last_emission/this.emission_delay);for(this.last_emission-=i*this.emission_delay;i--;){var n=this.settings.start_colours[Math.floor(this.settings.start_colours.length*Math.random())],o=this.settings.end_colours[Math.floor(this.settings.end_colours.length*Math.random())],a=this.settings.min_life+Math.random()*this.settings.life_range,s=[(o[0]-n[0])/a,(o[1]-n[1])/a,(o[2]-n[2])/a,(o[3]-n[3])/a];this.particles.push(new r(this.min_position.x+(this.position_vary?Math.random()*this.position_vary.x:0),this.min_position.y+(this.position_vary?Math.random()*this.position_vary.y:0),this.settings.min_angle+Math.random()*this.settings.angle_range,this.settings.min_speed+Math.random()*this.settings.speed_range,a,this.settings.min_size+Math.random()*this.settings.size_range,n.slice(),s))}}t/=1e3;for(var l=this.particles.length;l--;){var u=this.particles[l];if(u.dead)this.particles.splice(l,1);else if(u.lived+=t,u.lived>=u.life)u.dead=!0;else{u.vel.x+=this.settings.gravity.x*t,u.vel.y+=this.settings.gravity.y*t,u.pos.x+=u.vel.x*t,u.pos.y+=u.vel.y*t,u.colour[0]+=u.colour_step[0]*t,u.colour[1]+=u.colour_step[1]*t,u.colour[2]+=u.colour_step[2]*t,u.colour[3]+=u.colour_step[3]*t,this._render.beginFill("rgba("+Math.round(u.colour[0])+","+Math.round(u.colour[1])+","+Math.round(u.colour[2])+","+u.colour[3]+")");var c=this.pos.x+u.pos.x,h=this.pos.y+u.pos.y;this._render.arc(c,h,u.size,0,2*Math.PI),this._render.endFill()}}}else this.last_update=Date.now()}},{key:"render",value:function(){this._render.clear(),this.update()}}]),e}();t.Emitter=a}]);
//# sourceMappingURL=app.bundle.js.map